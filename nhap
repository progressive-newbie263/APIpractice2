document.getElementById('sign-in-form').addEventListener('submit', async function(e) {
  e.preventDefault(); // Prevent the default form submission

  // Get the email and password values
  const email = document.getElementById('email').value;
  const password = document.getElementById('password').value;

  // Make an HTTP POST request to login
  try {
      const response = await fetch('http://localhost:8082/api/login', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        // Remove credentials: 'include' for now
        body: JSON.stringify({
            email: email,
            password: password
        })
      });

      console.log("Response status:", response.status); // Log the status for debugging
      
      // If response is not OK, log the error details
      if (!response.ok) {
          const errorData = await response.text(); // Capture error as text (if provided)
          console.log("Error details:", errorData);
          alert('Login failed: ' + errorData);
          return;
      }

      // Parse the JSON response if login is successful
      const returnAccount = await response.json();
      console.log("Account data:", returnAccount);

      // Store the account name in localStorage
      localStorage.setItem('name', returnAccount.name);

      // Redirect to the homepage
      window.location.href = './amazon.html';

  } catch (error) {
      console.error('Error during login:', error);
      alert('An error occurred. Please try again.');
  }
});